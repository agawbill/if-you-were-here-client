{"ast":null,"code":"var _jsxFileName = \"/home/anthony/Desktop/if-you-were-here/client/src/containers/LoadMoreContainer/LoadMoreContainer.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchMoreMessages } from \"../../store/actions\";\nimport MessageSnapshot from \"../../components/MessageSnapshot/MessageSnapshot\";\nimport LoadMore from \"../../components/UI/Buttons/LoadMore/LoadMore\";\n\nconst LoadMoreContainer = props => {\n  const [messagesCutoff, setMessagesCutoff] = useState(14);\n  const [filteredCutoff, setFilteredCutoff] = useState(14);\n  const messagesCount = useSelector(state => state.messages.count);\n  const dispatch = useDispatch(); //calculate how many messages can be loaded that aren't already displayed\n  //if each respective value is greater than 0, the loadmore button should display\n\n  const filteredCalculation = props.filteredMessages.length - filteredCutoff;\n  const messageCalculation = props.messages.length - messagesCutoff; //in the future, if there were to be more than 1000 posts lets say, I would use the\n  //useEffect hook to call the api to load another 500 posts once messageCutoff reached a certain point (like 470)\n  // loading 500 posts at a time.\n\n  useEffect(() => {\n    const id = props.messages[props.messages.length - 1]._id;\n    dispatch(fetchMoreMessages(id, 500));\n  }, []); //calculate the marker (the amount of posts to load... another 14, or if there are less than 14 left to load,\n  //the remaining amount) and set the cutoff\n\n  const loadMoreFilteredMessages = count => {\n    const marker = filteredCalculation >= count ? count : filteredCalculation;\n    setFilteredCutoff(prevState => prevState + marker);\n  };\n\n  const loadMoreMessages = count => {\n    const marker = messageCalculation >= count ? count : messageCalculation;\n    setMessagesCutoff(prevState => prevState + marker);\n  };\n\n  let loadMessages = null;\n  let loadedMessages = null; //display the loadmore for unfiltered messages, or display the loadmore (button and messages) for filtered messages.\n\n  if (props.filteredMessages.length > 14) {\n    loadMessages = React.createElement(LoadMore, {\n      show: filteredCalculation > 0,\n      loadMoreMessages: loadMoreFilteredMessages,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    });\n    loadedMessages = props.filteredMessages.slice(14, filteredCutoff).map((message, index) => {\n      return React.createElement(MessageSnapshot, {\n        key: index,\n        entry: message,\n        marker: index + 14,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      });\n    });\n  } else if (props.messages.length > 14 && props.filteredMessages.length === 0) {\n    loadMessages = React.createElement(LoadMore, {\n      show: messageCalculation > 0,\n      loadMoreMessages: loadMoreMessages,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    });\n    loadedMessages = props.messages.slice(14, messagesCutoff).map((message, index) => {\n      return React.createElement(MessageSnapshot, {\n        key: index,\n        entry: message,\n        marker: index + 14,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      });\n    });\n  }\n\n  return React.createElement(React.Fragment, null, loadedMessages, loadMessages);\n};\n\nexport default LoadMoreContainer;","map":{"version":3,"sources":["/home/anthony/Desktop/if-you-were-here/client/src/containers/LoadMoreContainer/LoadMoreContainer.js"],"names":["React","useState","useEffect","useDispatch","useSelector","fetchMoreMessages","MessageSnapshot","LoadMore","LoadMoreContainer","props","messagesCutoff","setMessagesCutoff","filteredCutoff","setFilteredCutoff","messagesCount","state","messages","count","dispatch","filteredCalculation","filteredMessages","length","messageCalculation","id","_id","loadMoreFilteredMessages","marker","prevState","loadMoreMessages","loadMessages","loadedMessages","slice","map","message","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchMoreMessages } from \"../../store/actions\";\nimport MessageSnapshot from \"../../components/MessageSnapshot/MessageSnapshot\";\nimport LoadMore from \"../../components/UI/Buttons/LoadMore/LoadMore\";\n\nconst LoadMoreContainer = (props) => {\n  const [messagesCutoff, setMessagesCutoff] = useState(14);\n  const [filteredCutoff, setFilteredCutoff] = useState(14);\n  const messagesCount = useSelector((state) => state.messages.count);\n  const dispatch = useDispatch();\n\n  //calculate how many messages can be loaded that aren't already displayed\n  //if each respective value is greater than 0, the loadmore button should display\n  const filteredCalculation = props.filteredMessages.length - filteredCutoff;\n  const messageCalculation = props.messages.length - messagesCutoff;\n\n  //in the future, if there were to be more than 1000 posts lets say, I would use the\n  //useEffect hook to call the api to load another 500 posts once messageCutoff reached a certain point (like 470)\n  // loading 500 posts at a time.\n\n  useEffect(() => {\n    const id = props.messages[props.messages.length - 1]._id;\n    dispatch(fetchMoreMessages(id, 500));\n  }, []);\n\n  //calculate the marker (the amount of posts to load... another 14, or if there are less than 14 left to load,\n  //the remaining amount) and set the cutoff\n  const loadMoreFilteredMessages = (count) => {\n    const marker = filteredCalculation >= count ? count : filteredCalculation;\n    setFilteredCutoff((prevState) => prevState + marker);\n  };\n\n  const loadMoreMessages = (count) => {\n    const marker = messageCalculation >= count ? count : messageCalculation;\n    setMessagesCutoff((prevState) => prevState + marker);\n  };\n\n  let loadMessages = null;\n  let loadedMessages = null;\n\n  //display the loadmore for unfiltered messages, or display the loadmore (button and messages) for filtered messages.\n  if (props.filteredMessages.length > 14) {\n    loadMessages = (\n      <LoadMore\n        show={filteredCalculation > 0}\n        loadMoreMessages={loadMoreFilteredMessages}\n      />\n    );\n\n    loadedMessages = props.filteredMessages\n      .slice(14, filteredCutoff)\n      .map((message, index) => {\n        return (\n          <MessageSnapshot\n            key={index}\n            entry={message}\n            marker={index + 14}\n          ></MessageSnapshot>\n        );\n      });\n  } else if (\n    props.messages.length > 14 &&\n    props.filteredMessages.length === 0\n  ) {\n    loadMessages = (\n      <LoadMore\n        show={messageCalculation > 0}\n        loadMoreMessages={loadMoreMessages}\n      />\n    );\n\n    loadedMessages = props.messages\n      .slice(14, messagesCutoff)\n      .map((message, index) => {\n        return (\n          <MessageSnapshot\n            key={index}\n            entry={message}\n            marker={index + 14}\n          ></MessageSnapshot>\n        );\n      });\n  }\n\n  return (\n    <>\n      {loadedMessages}\n      {loadMessages}\n    </>\n  );\n};\n\nexport default LoadMoreContainer;\n"]},"metadata":{},"sourceType":"module"}